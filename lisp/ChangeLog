2004-05-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-300.el (riece-handle-312-message): Use server name
	returned by WHOIS instead of riece-real-server-name.
	[cf. <Liece:00170>]

2004-05-04  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.2.2 released.
	* riece-version.el (riece-version-number): Bump up to 0.2.2.

	* riece-ctlseq.el (riece-ctlseq-hide-controls): New user option.

	* riece-keyword.el (riece-keyword): Fixed the parent custom group.
	* riece-url.el (riece-url): Fixed the parent custom group.

2004-05-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctlseq.el: New add-on.
	* COMPILE (riece-modules): Add riece-ctlseq.
	* Makefile.am (EXTRA_DIST): Add riece-ctlseq.el.

2004-04-29  OHASHI Akira  <bg66@koka-in.org>

	* riece-log.el (riece-log-get-directory): Use a canonicalized
	channel name.
	(riece-log-open-directory-function): New user option.
	(riece-log-open-directory): Use it.
	(riece-log-insinuate): Add new key bind.

2004-04-05  Daiki Ueno  <ueno@unixuser.org>

	* riece-button.el (riece-button-requires): Abolish.

2004-03-29  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-buffer-alist): Rename *Commands* -> *Command*.
	(riece-command-mode): Rename Commands -> Command.

2004-03-28  Daiki Ueno  <ueno@unixuser.org>

	* riece-signal.el: Require 'riece-options for riece-debug.
	* riece-async.el: Require 'riece-options for riece-debug.

2004-03-28  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-command-mode): Don't display
	riece-freeze-indicator on the modeline of the command buffer.
	(riece-dialogue-mode): Make riece-freeze-indicator local to the
	buffer whose major-mode is derived from riece-dialogue-mode.

	* riece-display.el: Add autoload setting for derived-mode-class.
	(riece-update-status-indicators): Check riece-freeze flag for each
	buffer visible in the selected frame.

	* riece-commands.el: Add autoload setting for derived-mode-class.
	(riece-command-toggle-freeze): Don't switch to the channel buffer
	if major-mode of the current buffer is derived from
	riece-dialogue-mode.  Which allows to lock "*Others*" buffer.
	(riece-command-toggle-own-freeze): Ditto.

	* riece-globals.el (riece-freeze): Fix doc.
	(riece-freeze-indicator): Add doc.
	(riece-channel-indicator): Fix doc.
	(riece-long-channel-indicator): Fix doc.
	(riece-channel-list-indicator): Fix doc.
	(riece-user-indicator): Fix doc.
	(riece-away-indicator): Add doc.
	(riece-operator-indicator): Add doc.

2004-03-24  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Treat private messages as unread.

2004-03-21  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-exit): Don't clear riece-user-list-buffer and
	riece-channel-list-buffer.

2004-03-21  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-exit): Clear riece-channel-buffer,
	riece-user-list-buffer, and riece-channel-list-buffer.

2004-03-20  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-open-server): Append the server-name to
	the prompt string.

2004-03-14  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-display-connect-signals): Update
	riece-long-channel-indicator on 'channel-modes-changed signal.

	* riece-naming.el (riece-naming-assert-channel-modes): New
	function renamed from riece-handle-channel-modes.

	* riece-misc.el: Require 'riece-mode.
	(riece-concat-channel-modes): Display mode parameter.

	* riece-channel.el: Require 'riece-mode.
	(riece-channel-toggle-mode): Store mode "objects" instead of mode
	"flags".
	* riece-user.el: Require 'riece-mode.
	(riece-user-toggle-mode): Store mode "objects" instead of mode
	"flags".

	* riece-handle.el: Require 'riece-mode.
	(riece-handle-mode-message): Use riece-parse-mode.
	(riece-parse-mode): Moved to riece-mode.el.
	(riece-handle-channel-modes): Moved to riece-naming.el.

	* riece-300.el: Require 'riece-mode.
	(riece-handle-324-message): Use riece-parse-mode.

	* riece-mode.el: New file.
	* Makefile.am (EXTRA_DIST): Add riece-mode.el.
	* COMPILE (riece-modules): Add riece-mode.

2004-03-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el: "Error occurred in XXX" -> "Error in XXX".
	* riece-filter.el: "Error occurred in XXX" -> "Error in XXX".
	* riece-signal.el: "Error occurred in XXX" -> "Error in XXX".

2004-03-09  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.2.1 released.
	* riece-version.el (riece-version-number): Bump up to 0.2.1.

2004-03-09  Daiki Ueno  <ueno@unixuser.org>

	* riece-emacs.el (riece-propertize-modeline-string): Fix arguments
	for add-text-properties.

2004-03-08  Daiki Ueno  <ueno@unixuser.org>

	* riece-xface.el (riece-xface-insinuate): Use
	riece-user-list-mode-hook to setup riece-update-buffer-functions
	in user-list buffer.

2004-03-07  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.2.0 released.
	* riece-version.el (riece-version-number): Bump up to 0.2.0.

	* riece-ctcp.el (riece-handle-ctcp-version-request): Fixed bug in
	formatting target identity.
	(riece-handle-ctcp-ping-request): Ditto.
	(riece-handle-ctcp-clientinfo-request): Ditto.

2004-03-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el: Rename some signals.

	* riece-commands.el (riece-command-set-operators): Reverse user-list.
	(riece-command-set-speakers): Ditto.

2004-03-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el
	(riece-unread-format-identity-for-channel-list-indicator): Escape
	% -> %%; use riece-propertize-modeline-string.

	* riece-history.el
	(riece-history-format-identity-for-channel-list-indicator): Escape
	% -> %%; use riece-propertize-modeline-string.

	* riece-highlight.el
	(riece-highlight-format-identity-for-channel-list-indicator):
	Escape % -> %%; use riece-propertize-modeline-string.

	* riece-display.el
	(riece-format-identity-for-channel-list-indicator): Escape % ->
	%%.
	(riece-update-channel-list-indicator): Rewrite.

	* riece-emacs.el (riece-propertize-modeline-string): New function.
	* riece-xemacs.el (riece-propertize-modeline-string): New function.

2004-03-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el
	(riece-unread-format-identity-for-channel-list-indicator): New
	function.
	(riece-unread-insinuate): Setup
	riece-format-identity-for-channel-list-indicator-functions.

	* riece-history.el
	(riece-history-format-identity-for-channel-list-buffer): New
	function.
	(riece-history-insinuate): Setup
	riece-format-identity-for-channel-list-indicator-functions.

	* riece-highlight.el
	(riece-highlight-format-identity-for-channel-list-indicator): New
	function.
	(riece-highlight-insinuate): Setup
	riece-format-identity-for-channel-list-indicator-functions.

	* riece-display.el
	(riece-format-identity-for-channel-list-buffer): Rename from
	riece-format-channel-list-line.
	(riece-format-identity-for-channel-list-indicator): New function.
	(riece-update-channel-list-indicator): Use it.

2004-03-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-handle.el (riece-parse-modes): Make sure that mode params
	are started at the beginning of the mode string.
	(riece-handle-channel-modes): Fixed arguments passed to
	riece-channel-toggle-*.

2004-03-06  Daiki Ueno  <ueno@unixuser.org>

	* riece-xface.el (riece-xface-insinuate): Set
	'riece-update-buffer-functions local to the user-list buffer.

	* riece-unread.el: Require 'riece-signal instead of
	'riece-display.
	(riece-unread-after-display-message-function): Emit
	'riece-update-buffer signal instead of
	'riece-unread-channel-list-update signal.

	* riece-ndcc.el: Don't require 'riece-display.

	* riece-naming.el: Require 'riece-signal instead of
	'riece-display.
	(riece-naming-assert-rename): Don't rename buffer.

	* riece-history.el (riece-history-format-channel-list-line): Don't
	append "\n".

	* riece-handle.el: Require 'riece-signal instead of
	'riece-display.
	(riece-parse-modes): Rename from riece-parse-channel-modes; don't
	update channel modes.
	(riece-handle-channel-modes): New function which processes the
	result of riece-parse-modes.
	(riece-handle-mode-message): Use it.

	* riece-filter.el: Don't require 'riece-display.
	* riece-display.el: Require 'riece-signal; connect
	'riece-update-buffer signal.

	* riece-ctcp.el: Don't require 'riece-display.

	* riece-signal.el: New module splitted from riece-display.el.
	* Makefile.am (EXTRA_DIST): Add riece-signal.
	* COMPILE (riece-modules): Add riece-signal.

2004-03-05  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Emit 'riece-unread-channel-list-update signal.
	(riece-unread-insinuate): Connect the signal to the function which
	updates channel-list buffer.

	* riece-display.el (riece-display-connect-signals): Fix parenthesis.

2004-03-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-emit-signal): Fixed bug that errors
	during signal filter execution were not caught.
	(riece-display-connect-signals): Check riece-current-channel is set.

2004-03-01  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-display-connect-signals): Fixed bug in
	signal filters.

	* riece-handle.el (riece-handle-mode-message): Don't call
	riece-parse-channel-modes if channel doesn't match with
	riece-channel-regexp.

2004-02-28  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-display-connect-signals): Connect some
	signals.

	* riece-naming.el (riece-naming-assert-join): Don't change the
	current channel manually.
	(riece-naming-assert-part): Ditto.
	(riece-naming-assert-rename): Ditto.
	(riece-naming-assert-channel-users): Ditto.

2004-02-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-emit-signal): Create signal object
	internally.

	* riece-message.el (riece-display-message-1): Emit
	'riece-buffer-toggle-freeze signal.

	* riece-commands.el (riece-command-toggle-freeze): Emit
	'riece-buffer-toggle-freeze signal; don't update status indicators
	manually.
	(riece-command-toggle-own-freeze): Ditto.
	
	* riece-naming.el (riece-naming-assert-join): Rename signal 'join
	-> 'riece-naming-assert-join.
	(riece-naming-assert-part): Rename signal 'part ->
	'riece-naming-assert-part.
	(riece-naming-assert-rename): Rename signal 'rename ->
	'riece-naming-assert-rename.
	(riece-naming-assert-channel-users): Rename from
	riece-naming-assert-users; rename signal 'users ->
	'riece-naming-assert-channel-users.

	* riece-handle.el (riece-handle-topic-message): Emit
	'riece-channel-set-topic signal.
	(riece-parse-channel-modes): Emit 'riece-channel-toggle-operator,
	'riece-channel-toggle-speaker, and 'riece-channel-toggle-modes signals.

	* riece-display.el (riece-display-connect-signals): Rename some
	signals; connect more signals.

	* riece-300.el (riece-handle-302-message): Emit
	'riece-user-toggle-away, and 'riece-user-toggle-operator signals;
	don't update status indicators manually.
	(riece-handle-301-message): Emit 'riece-user-toggle-away signal;
	don't update status indicators manually.
	(riece-handle-305-message): Ditto.
	(riece-handle-306-message): Ditto.
	(riece-handle-353-message): Follow the name change of
	riece-naming-assert-users.
	(riece-handle-324-message): Emit 'riece-channel-toggle-modes
	signal; don't update status indicators manually.
	(riece-handle-set-topic): Emit 'riece-channel-set-topic signal;
	don't update channel indicator manually.
	(riece-handle-352-message): Emit 'riece-user-toggle-away, and
	'riece-user-toggle-operator signals; don't update status
	indicators manually.

2004-02-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-connect-signal): Create slot object
	internally.

2004-02-27  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece): Setup signal slots.

	* riece-unread.el (riece-unread-after-display-message-function):
	Don't call riece-redisplay-buffers.

	* riece-naming.el (riece-naming-assert-names): New function.
	(riece-naming-assert-join): Emit 'join signal.
	(riece-naming-assert-part): Emit 'part signal.
	(riece-naming-assert-rename): Emit 'rename signal.

	* riece-message.el (riece-message-buffer): Don't call
	riece-redisplay-buffers.

	* riece-handle.el (riece-handle-nick-message): Don't call
	riece-redisplay-buffers.
	(riece-handle-join-message): Ditto.
	(riece-handle-part-message): Ditto.
	(riece-handle-kick-message): Ditto.
	(riece-handle-kill-message): Ditto.
	(riece-handle-topic-message): Ditto.
	(riece-parse-channel-modes): Ditto.

	* riece-display.el (riece-update-user-list-buffer): Use
	riece-with-server-buffer.
	(riece-emit-signal): Notify if signal filter fails.
	(riece-display-connect-signals): New function.
	(riece-update-user-list-buffer): Don't switch to user-list buffer.
	(riece-update-channel-list-buffer): Don't switch to channel-list
	buffer.
	(riece-switch-to-channel): Emit 'switch-to-channel signal.
	(riece-switch-to-nearest-channel): Ditto.

	* riece-commands.el (riece-command-switch-to-channel): Don't call
	riece-redisplay-buffers.
	(riece-command-join-partner): Ditto.
	(riece-command-part): Ditto.

	* riece-300.el (riece-handle-353-message): Save match data before
	calling riece-naming-assert-names; don't call riece-redisplay-buffers.
	(riece-handle-322-message): Don't call riece-redisplay-buffers.

2004-02-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el: Introduce Qt like "signal-slot" abstraction
	for routing display events.
	(riece-signal-slot-obarray): New variable.
	(riece-make-slot): New function.
	(riece-slot-function): New function.
	(riece-slot-filter): New function.
	(riece-slot-handback): New function.
	(riece-make-signal): New function.
	(riece-signal-name): New function.
	(riece-signal-args): New function.
	(riece-connect-signal): New function.
	(riece-emit-signal): New function.

2004-02-19  Daiki Ueno  <ueno@unixuser.org>

	* riece-300.el (riece-handle-353-message): Add 'riece-identity
	property on user list string.

2004-02-17  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el: Add autoload setting for
	lsdb-rebuild-secondary-hash-tables to suppress warning.

2004-02-16  Daiki Ueno  <ueno@unixuser.org>

	* riece-300.el (riece-handle-353-message): Print user list in
	channel buffer.

2004-02-14  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* riece-lsdb.el (riece-lsdb-lookup-records): Build
	riece-lsdb-cache if necessary.

2004-01-29  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el (riece-handle-ctcp-version-request): Format target
	identity before display.
	(riece-handle-ctcp-ping-request): Ditto.
	(riece-handle-ctcp-clientinfo-request): Ditto.

2004-01-28  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.8 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.8.

2004-01-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el: Require 'riece-identity; add autoload setting for
	lsdb-update-record; bind lsdb-hash-table, riece-command-mode-map.

2004-01-23  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-handle.el (riece-handle-privmsg-message): Check own
	message from server. For deal with another client that connected
	same irc proxy (e.g. plum, pirc).
	(riece-handle-notice-message): Ditto.

2004-01-21  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-identity-canonicalize-prefix): Convert
	characters in prefix to lower case.

2004-01-18  Daiki Ueno  <ueno@unixuser.org>

	* riece-misc.el (riece-concat-user-status): New function.

	* riece-300.el (riece-handle-302-message): Simplify user status
	display.  (i.e. don't display "not operator", "not away", ...)
	(riece-handle-352-message): Ditto.

2004-01-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el (riece-lsdb-add-user): Always pass canonical
	address for 'net entry.

2004-01-04  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-300.el (riece-handle-317-message): Fix regexp for signon
	time extenstion.

2004-01-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el: Add autoload setting for lsdb-maphash.
	(riece-lsdb-update-cache): Don't alter existing entry.
	(riece-lsdb-delete-cache): Ditto.
	(riece-lsdb-add-user): New command.
	(riece-lsdb-insinuate): Bind riece-lsdb-add-user.

2004-01-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el (riece-lsdb-insinuate): Don't require 'lsdb.

2004-01-02  Daiki Ueno  <ueno@unixuser.org>

	* riece-lsdb.el: New add-on.
	* COMPILE (riece-modules): Add riece-lsdb.
	* Makefile.am (EXTRA_DIST): Add riece-lsdb.el

	* riece-xface.el: New add-on.
	* COMPILE (riece-modules): Add riece-xface.
	* Makefile.am (EXTRA_DIST): Add riece-xface.el

2003-12-25  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.7 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.7.

2003-12-22  Daiki Ueno  <ueno@unixuser.org>

	* riece-keyword.el (riece-notify-keyword-functions): Mark as
	obsolete.
	(riece-keyword-notify-functions): New user option.
	(riece-keyword-message-filter): Don't restore the match data when
	calling riece-notify-keyword-functions; call
	riece-keyword-notify-functions with the matched message object.
	Thanks to OHASHI Akira <bg66@koka-in.org>
	[cf. <Liece:00134>]

2003-12-17  Daiki Ueno  <ueno@unixuser.org>

	* riece-log.el (riece-log-flashback): Use
	riece-match-string-no-properties instead of match-string-no-properties.

	* riece-xemacs.el (riece-match-string-no-properties): New function.
	* riece-emacs.el (riece-match-string-no-properties): New alias.

	* riece-identity.el: Don't require 'riece-compat.
	(riece-identity-prefix-case-table): Abolish.
	(riece-identity-prefix-case-pair-alist): New constant.
	(riece-identity-canonicalize-prefix): Don't use case-table.

	* riece-emacs.el (riece-set-case-syntax-pair): Abolish.
	(riece-copy-case-table): Abolish.
	* riece-xmacs.el (riece-set-case-syntax-pair): Abolish.
	(riece-copy-case-table): Abolish.

2003-12-15  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el: Require 'riece-version.
	(riece-quit-message): Set default to (riece-extended-version).
	(riece-away-message): Set default to "Gone".

	* riece-commands.el: Don't require 'riece-version.
	(riece-command-quit): Don't check riece-quit-message.
	(riece-command-close-server): Ditto.
	(riece-command-toggle-away): Always supply a parameter to the AWAY
	command when the user is not away.  Thanks to Yuki Fujimura
	<fujimura@wakhok.ac.jp>
	[cf. <Liece:00139>]

2003-12-14  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece): Connect to servers in riece-startup-server-list.

	* riece-000.el (riece-handle-001-message): Ignore entries in
	riece-startup-channel-list which doesn't match riece-server-name. 

	* riece-options.el (riece-startup-server-list): New user option.

	* riece-async.el (riece-async-max-buffer-size): New user option.
	(riece-async-server-program): Use io/nonblock & IO#syswrite to
	check whether the write end of pipe (i.e. input to emacs process)
	would block.

2003-12-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-default-open-connection-function): New
	user option.

	* riece-server.el (riece-server-keyword-map): Use
	riece-default-open-connection-function.

	* riece-async.el: New add-on.
	* COMPILE (riece-modules): Add riece-async.
	* Makefile.am (EXTRA_DIST): Add riece-async.el

2003-12-09  OHASHI Akira  <bg66@koka-in.org>

	* riece-mini.el (riece-mini-display-message-function): Don't set
	riece-mini-last-channel when message is not a privmsg.

2003-12-04  OHASHI Akira  <bg66@koka-in.org>

	* riece-server.el (riece-with-server-buffer): Store 'edebug-form-spec
	property.

2003-12-03  OHASHI Akira  <bg66@koka-in.org>

	* riece-log.el (riece-log-requires): New function.
	(riece-log-flashback): Revert 'riece-identity property and button.

2003-11-28  OHASHI Akira  <bg66@koka-in.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Do nothing when message is not a privmsg.

2003-11-22  Daiki Ueno  <ueno@unixuser.org>

	* riece-log.el (riece-log-coding-system): New user option.
	(riece-log-display-message-function): Bind
	coding-system-for-write; don't create temp buffer.

	* riece-rdcc.el (riece-rdcc-filter): Use write-region instead of
	append-to-file to suppress "Wrote file" messages.

2003-11-10  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.6 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.6.

2003-11-08  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el (riece-command-ctcp-action): Display channel names
	in "*Others*" buffer.

2003-11-05  OHASHI Akira  <bg66@koka-in.org>

	* riece-unread.el (riece-unread-switch-to-channel): Protect
	switching to the channel not existing.

2003-10-29  OHASHI Akira  <bg66@koka-in.org>

	* riece-log.el (riece-log-get-directory): Support riece-identity
	for mapping.

2003-10-28  Daiki Ueno  <ueno@unixuser.org>

	* riece-layout.el (riece-set-window-points): Move point in
	the channel-buffer's window.

	* riece-ctcp.el (riece-command-ctcp-version): Prompt to select
	an identity on the current server.
	(riece-command-ctcp-ping): Ditto.
	(riece-command-ctcp-clientinfo): Ditto.
	(riece-command-ctcp-action): Ditto.

	* riece-commands.el (riece-command-change-mode): Prompt to select
	an identity on the current server.
	(riece-command-join): Ditto.

2003-10-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-keyword.el (riece-keywords): Change custom spec.
	(riece-keyword-message-filter): Normalize riece-keywords.

	* riece-identity.el (riece-identity-prefix-case-table): Use
	riece-copy-case-table to define.

	* riece-xemacs.el (riece-set-case-syntax-pair): Workaround for
	XEmacs 21.1.
	(riece-copy-case-table): Ditto.

	* riece-emacs.el (riece-copy-case-table): New alias.

	* riece-globals.el (riece-channel-regexp): Use
	riece-make-interval-regexp to define.
	(riece-user-regexp): Ditto.

	* riece-compat.el (riece-make-interval-regexp): New function.

	* riece-icon.el (riece-icon-available-p): Check
	the existence of image-type-available-p.

2003-10-27  OHASHI Akira  <bg66@koka-in.org>

	* riece-log.el (riece-log-get-directory): Fix for server name and
	private messages handling.

2003-10-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-xemacs.el (riece-run-with-idle-timer): Pass an integer to
	the RESTART argument of start-itimer.

	* riece-commands.el (riece-command-user-list-scroll-down): Rename
	from riece-command-nick-scroll-down.
	(riece-command-user-list-scroll-up): Rename from
	riece-command-nick-scroll-up.
	(riece-command-scroll-down): Check if riece-current-channel is bound.
	(riece-command-scroll-up): Ditto.
	(riece-command-quit): Clean up if no server process is available.

2003-10-25  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el: Bind temporary-file-directory.
	(riece-rdcc-send-program): Allow block-size to be controlled from
	elisp.
	(riece-rdcc-block-size): New user option.
	(riece-rdcc-temp-file): New variable.
	(riece-rdcc-received-size): New variable.
	(riece-rdcc-filter): Don't keep received bytes in the process
	buffer; use riece-rdcc-format-size to display progress.
	(riece-command-dcc-receive): Create a temporary directory which
	holds a received file.

2003-10-24  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-gather-channel-modes): Default to nil.
	* riece-handle.el (riece-handle-join-message): Send MODE if
	riece-gather-channel-modes is non-nil.

	* riece-url.el: Add autoload setting for 'browse-url.

	* riece-menu.el: Require 'riece-options, 'riece-globals,
	'riece-identity, 'riece-layout, and 'riece-server; bind
	riece-command-mode-map.

	* riece-history.el: Require 'riece-options, 'riece-globals,
	'riece-highlight, and 'riece-identity.

	* riece-naming.el (riece-naming-assert-rename): Fixed.

2003-10-24  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.5 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.5.

2003-10-24  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el (riece-command-ctcp-action): If the current
	command line is not empty, insert it into the minibuffer before
	reading input.  Thanks to Akinori MUSHA  <knu@iDaemons.org>
	[cf. <Liece:00123>]

	* riece.el: Add autoload setting for derived-mode-class.
	(riece-shrink-buffer-idle-timer): New variable.
	(riece): Set idle timer to shrink channel buffers.
	(riece-shrink-buffer): New function.

	* riece-xemacs.el (riece-overlays-in): New function.
	(riece-delete-overlay): New alias.
	(riece-kill-all-overlays): New function.

	* riece-server.el (riece-quit-server-process): Don't set timer if
	riece-quit-timeout is nil.

	* riece-options.el (riece-quit-timeout): Change custom type.
	(riece-shrink-buffer-idle-time-delay): New user option.
	(riece-max-buffer-size): New user option.

	* riece-icon.el (riece-icon-add-image-region) [XEmacs]: Delete
	extents if already exists.

	* riece-emacs.el (riece-overlays-in): New alias.
	(riece-delete-overlay): New alias.
	(riece-kill-all-overlays): New function.
	(riece-run-with-idle-timer): New alias.
	(riece-cancel-timer): New alias.

	* riece-display.el (riece-update-user-list-buffer): Kill all
	overlays in buffer.
	(riece-update-channel-list-buffer): Ditto.

	* riece-commands.el (riece-command-set-operators): Reset group.
	(riece-command-set-speakers): Ditto.

2003-10-23  Daiki Ueno  <ueno@unixuser.org>

	* riece-naming.el (riece-naming-assert-rename): Follow the
	change of riece-channel.el.

	* riece-message.el (riece-message-external-p): Follow the
	change of riece-channel.el.

	* riece-display.el (riece-update-user-list-buffer): Follow the
	change of riece-channel.el.

	* riece-commands.el (riece-command-kick): Follow the change of
	riece-channel.el.
	(riece-command-set-operators): Ditto.
	(riece-command-set-speakers): Ditto.

	* riece-button.el (riece-user-button-set-operators): Follow the
	change of riece-channel.el.
	(riece-user-button-set-speakers): Ditto.

	* riece-channel.el (riece-make-channel): Abolish 2nd and 3rd
	arguments.
	(riece-get-channel): Follow the change of riece-make-channel.
	(riece-channel-operators): Abolish.
	(riece-channel-speakers): Abolish.
	(riece-channel-set-operators): Abolish.
	(riece-channel-set-speakers): Abolish.
	(riece-channel-get-operators): Abolish.
	(riece-channel-get-speakers): Abolish.
	(riece-channel-toggle-user): Follow the change of the return type
	of riece-channel-users.
	(riece-channel-toggle-operator): Ditto.
	(riece-channel-toggle-speaker): Ditto.
	(riece-channel-operator-p): Abolish.
	(riece-channel-speaker-p): Abolish.
	(riece-channel-intern-user): Abolish.

2003-10-23  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-identity-member): Take an optional 3rd
	argument to instruct to use riece-identity-equal-no-server.
	(riece-identity-assoc): Ditto.

	* riece-display.el (riece-update-user-list-buffer): Use
	riece-channel-operator-p and riece-channel-speaker-p.

	* riece-button.el (riece-user-button-set-operators): Use
	riece-channel-operator-p.
	(riece-user-button-set-speakers): Use riece-channel-speaker-p.

	* riece-channel.el (riece-channel-intern-user): New function.
	(riece-channel-toggle-operator): Use it.
	(riece-channel-toggle-speaker): Use it.
	(riece-channel-operator-p): New function.
	(riece-channel-speaker-p): New function.

2003-10-23  OHASHI Akira  <bg66@koka-in.org>

	* riece-log.el (riece-log-get-directory): Follow the change of
	`riece-channel-regexp'.

2003-10-22  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-format-identity): Return copied strings.

2003-10-22  OHASHI Akira  <bg66@koka-in.org>

	* riece.el (riece): When riece server was opened, Do
	`riece-command-configure-windows' instead of signaling.

2003-10-22  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-rdcc-send-program): Flush $stdout before
	accepting a connection.
	(riece-command-dcc-send): Use riece-completing-read-identity; take
	an identity object in the 1st argument.
	(riece-rdcc-format-size): New function.
	(riece-handle-dcc-request): Use it.

	* riece-ndcc.el (riece-command-dcc-send): Use
	riece-completing-read-identity; take an identity object in the 1st
	argument.

	* riece-display.el (riece-update-buffers): Run
	riece-update-buffer-hook.

	* riece-button.el (riece-user-button-finger): Pass an identity
	object instead of the prefix.

	* riece-ctcp.el: Require 'riece-highlight.
	(riece-ctcp-action-face): New face.
	(riece-ctcp-action-face): New variable.
	(riece-ctcp-action-prefix): New variable.
	(riece-ctcp-requires): Require 'riece-highlight if it is enabled.
	(riece-ctcp-insinuate): Modify riece-dialogue-font-lock-keywords
	if 'riece-highlight is enabled.
	(riece-handle-ctcp-action-request): Prepend
	riece-ctcp-action-prefix instead of riece-change-prefix.
	(riece-command-ctcp-action): Ditto.

	* riece-server.el (riece-quit-server-process): Use riece-run-at-time.
	* riece-xemacs.el (riece-run-at-time): New function.
	* riece-emacs.el (riece-run-at-time): New alias.

	* riece-misc.el (riece-get-identities-on-server): New function.
	(riece-get-users-on-server): Use it.

	* riece-ctcp.el (riece-ctcp-completing-read-identity): Abolish.
	(riece-command-ctcp-version): Use riece-completing-read-identity
	and riece-get-identities-on-server.
	(riece-command-ctcp-ping): Ditto.
	(riece-command-ctcp-clientinfo): Ditto.
	(riece-command-ctcp-action): Ditto.

	* riece-commands.el (riece-command-finger): Pass the current
	server name to riece-get-users-on-server; use
	riece-completing-read-identity.
	(riece-command-invite): Ditto.
	(riece-command-enter-message-to-user): Ditto.

	* riece-000.el (riece-handle-001-message): Register myself with
	riece-obarray.

2003-10-21  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el (riece-ctcp-completing-read-identity): New
	function.
	(riece-command-ctcp-version): Use it.
	(riece-command-ctcp-ping): Ditto.
	(riece-command-ctcp-clientinfo): Ditto.
	(riece-command-ctcp-action): Ditto; don't encode CHANNEL identity
	twice.

2003-10-20  Daiki Ueno  <ueno@unixuser.org>

	* riece-xemacs.el (riece-xemacs-mode-line-buffer-identification):
	Abolish.
	(riece-mode-line-buffer-identification): Don't define alias.

	* riece-server.el (riece-open-server): Handle errors occurred
	during reading password.

	* riece-options.el (riece-addons): Add riece-icon.

	* riece-layout.el (riece-configure-windows-top): Collect arguments.

	* riece-icon.el: New add-on.
	* COMPILE (riece-modules): Add riece-icon.
	* Makefile.am (EXTRA_DIST): Add riece-icon.el

2003-10-20  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-saved-forms): Add riece-layout.

	* riece-layout.el (riece-layout-alist): Change format.
	(riece-configure-windows): Take 2 args to specify the position of
	the command buffer window.

	* riece-commands.el (riece-command-change-layout): Set
	riece-save-variables-are-dirty.

2003-10-19  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.4 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.4.

2003-10-19  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-server-process-opened): Return t.

	* riece.el (riece-dialogue-mode-map): Bind "p" to
	riece-command-enter-message-to-user.

	* riece-misc.el (riece-current-nickname): Use
	riece-current-server-name.
	(riece-get-users-on-server): Ditto.

	* riece-server.el (riece-current-server-name): New function.
	(riece-send-string): Use it.

	* riece-commands.el (riece-command-enter-message-to-user): New command.

2003-10-19  Daiki Ueno  <ueno@unixuser.org>

	* riece-menu.el (riece-menu-create-layouts-menu): New function.
	(riece-menu-items): Use it.

	* riece-server.el (riece-server-process-opened): New function.
	(riece-server-opened): Use it.

	* riece-url.el: Require 'riece-menu.
	(riece-url-insinuate): Add "Open URL..." menu in
	riece-command-mode-hook.

	* riece-options.el (riece-addons): Add riece-menu.

	* riece-menu.el: New add-on.
	* COMPILE (riece-modules): Add riece-menu.
	* Makefile.am (EXTRA_DIST): Add riece-menu.el

2003-10-19  Daiki Ueno  <ueno@unixuser.org>

	* riece-version.el (riece-extended-version): Remove interactive spec.
	(riece-version): New command.
	* riece.el (riece-command-map): Bind "V" to riece-version.

	* riece-options.el (riece-command-prefix): New user option.
	(riece-tab-stop-list): Abolish.

	* riece.el (riece-define-keys-1): If keymap is a list, eval the
	2nd element of it.
	(riece-select-keys): Use riece-command-prefix instead of "\C-c".
	(riece-command-map): Ditto.
	(riece-dialogue-mode): Don't set tab-stop-list.

2003-10-18  Daiki Ueno  <ueno@unixuser.org>

	* riece-keyword.el (riece-keyword-message-filter): Ignore messages
	which belongs to myself.

	* riece-commands.el (riece-command-topic): Use
	riece-check-channel-commands-are-usable.
	(riece-command-invite): Ditto.
	(riece-command-kick): Ditto.
	(riece-command-change-mode): Ditto.
	(riece-command-set-operators): Ditto.
	(riece-command-set-speakers): Ditto.
	(riece-command-send-message): Ditto.
	(riece-command-part): Ditto.

	* riece-misc.el (riece-get-users-on-server): If
	riece-current-channel is not set, check the default server.
	(riece-check-channel-commands-are-usable): New function.

	* riece-globals.el (riece-channel-regexp): Accept channel names
	beginning with "!!".

2003-10-16  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-commands.el (riece-command-universal-server-name-argument):
	Fix parenthesis.

2003-10-16  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-buffer-alist): Rename from
	riece-buffer-mode-alist.

	* riece-misc.el (riece-get-buffer-create): Takes an optional 2nd
	argument, init-major-mode, which is used to assert the major-mode
	of the created buffer.

	* riece-naming.el (riece-naming-assert-rename): Merged buffer
	renaming logic that riece-handle-nick-message was responsible for.

	* riece-globals.el (riece-server-process-alist): Revive.
	(riece-process-list): Abolish.
	(riece-command-buffer): Set default to nil.
	(riece-dialogue-buffer): Ditto.
	(riece-others-buffer): Ditto.
	(riece-channel-list-buffer): Ditto.
	(riece-user-list-buffer): Ditto.
	(riece-private-buffer): Abolish.
	(riece-wallops-buffer): Abolish.

	* riece-display.el (riece-channel-buffer-format): Moved from
	riece-globals.
	(riece-channel-buffer-alist): New variable.
	(riece-channel-buffer-create): Assert the major-mode of the
	created buffer is 'riece-channel-mode.
	(riece-channel-buffer): New function.
	(riece-switch-to-channel): Use riece-channel-buffer instead of
	directly using get-buffer.

2003-10-14  Daiki Ueno  <ueno@unixuser.org>

	* riece-commands.el (riece-command-toggle-away): Check user away
	status in the server buffer.
	[cf. <Liece:00119>]
	(riece-command-names): Use identity prefix
	instead of formatted identity.
	(riece-command-who): Ditto.

2003-10-14  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece.el (riece-dialogue-mode-map): Bind "N" instead of "\C-n"
	to `riece-command-name'.

2003-10-14  Daiki Ueno  <ueno@unixuser.org>

	* riece-layout.el (riece-reconfigure-windows-predicate): Simplified.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.3 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.3.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-button.el (riece-button-map-identity-region): Abolish.
	(riece-user-button-set-operators): Use riece-scan-property-region.
	(riece-user-button-set-speakers): Ditto.
	(riece-button-add-identity-button): Ditto.

	* riece-keyword.el: Require 'riece-message.
	(riece-keyword-map-region): Abolish.
	(riece-keyword-scan-region): Use riece-scan-property-region.

	* riece-misc.el (riece-scan-property-region): New function.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-xemacs.el (riece-make-overlay): New alias.
	(riece-overlay-put): New alias.
	(riece-overlay-start): New alias.
	(riece-overlay-buffer): New alias.

	* riece-emacs.el (riece-make-overlay): New alias.
	(riece-overlay-put): New alias.
	(riece-overlay-start): New alias.
	(riece-overlay-buffer): New alias.

	* riece-keyword.el: New add-on.
	* COMPILE (riece-modules): Add riece-keyword.
	* Makefile.am (EXTRA_DIST): Add riece-keyword.el

	* riece-message.el (riece-message-filter-functions): New user option.
	(riece-display-message-1): New function.
	(riece-display-message): Use it.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-channel-list-mode): Initialize
	riece-update-buffer-functions.
	(riece-user-list-mode): Ditto.

	* riece-globals.el (riece-channel-indicator): Rename from
	riece-short-channel-indicator.
	(riece-long-channel-indicator): Rename from
	riece-channel-indicator.

	* riece-display.el (riece-update-buffer-functions): Default to
	nil.
	(riece-update-indicator-functions): New variable splitted from
	riece-update-buffer-functions.
	(riece-update-channel-indicator): Rename from
	riece-update-short-channel-indicator.
	(riece-update-long-channel-indicator): Rename from
	riece-update-channel-indicator.
	(riece-update-buffers): Don't set riece-channel-buffer.
	(riece-switch-to-channel): Set riece-channel-buffer here.

	* riece-button.el (riece-user-button-popup-menu): Change order.
	(riece-button-update-buffer): Unify
	riece-button-update-channel-list-buffer and
	riece-button-update-user-list-buffer.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-history.el (riece-history-insinuate): In
	riece-after-switch-to-channel-functions, check whether the last
	channel is nil.

	* riece-xemacs.el (riece-event-buffer): New alias.
	(riece-event-point): New alias.

	* riece-emacs.el (riece-event-buffer): New function.
	(riece-event-point): New function.

	* riece-display.el (riece-update-user-list-buffer): Use
	riece-format-identity to add 'riece-identity property to user
	names.

	* riece-button.el (riece-user-button-popup-menu): New variable.
	(riece-identity-button): Rename from riece-channel-button.
	(riece-button-switch-to-identity): Rename from
	riece-channel-button-action.
	(riece-identity-button-popup-menu): Rename from
	riece-channel-button-popup-menu; set point to the position the
	event occurred.
	(riece-user-button-join-partner): New function.
	(riece-user-button-set-operators): New function.
	(riece-user-button-set-speakers): New function.
	(riece-user-button-finger): New function.
	(riece-make-identity-button-map): New function.
	(riece-button-map-identity-region): New function; splitted from
	riece-button-add-identity-button.
	(riece-button-add-identity-button): Use it.
	(riece-button-update-user-list-buffer): New function.
	(riece-button-insinuate): Add riece-button-update-user-list-buffer
	to riece-update-buffer-functions.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-xemacs.el (riece-mouse-2): New variable.
	(riece-popup-menu-popup): New function.

	* riece-emacs.el (riece-mouse-2): New variable.
	(riece-popup-menu-bogus-filter-constructor): New macro.
	(riece-popup-menu-popup): New function.

	* riece-commands.el (riece-command-list): Use identity prefix
	instead of formatted identity.

	* riece-button.el (riece-channel-button-popup-menu): New variable.
	(riece-channel-button): Arrange help-echo.
	(riece-channel-button-switch-to-channel): New function.
	(riece-channel-button-part): New function.
	(riece-channel-button-list): New function.
	(riece-channel-button-map): New variable.
	(riece-button-add-channel-buttons): Add 'local-map and 'keymap
	properties on channel buttons.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-button.el (riece-button-insinuate): Buttonize channel buffers.

	* riece-history.el (riece-channel-list-history-face): New face.
	(riece-history-format-channel-list-line): New function.
	(riece-history-insinuate): Add ?+ to
	riece-channel-list-mark-face-alist; add
	riece-history-format-channel-list-line to
	riece-format-channel-list-line-functions.

	* riece-highlight.el (riece-channel-list-current-face): Arrange colors.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Do nothing when message-target is already in
	riece-unread-channels; call riece-redisplay-buffers.
	(riece-unread-update-channel-list-buffer): Abolish.
	(riece-unread-after-switch-to-channel-function): Don't call
	riece-unread-update-channel-list-buffer.
	(riece-unread-format-channel-list-line): New function.
	(riece-unread-insinuate): Add
	riece-unread-format-channel-list-line to
	riece-format-channel-list-line; don't add
	riece-unread-update-channel-list-buffer to
	riece-update-buffer-functions.

	* riece-highlight.el (riece-channel-list-mark-current-channel):
	Abolish; merged into riece-update-channel-list-buffer.
	(riece-highlight-insinuate): Don't add
	riece-channel-list-mark-current-channel to
	riece-after-switch-to-channel-functions.

	* riece-display.el (riece-channel-list-changed): Abolish.
	(riece-update-channel-list-buffer): Always redisplay channel-list
	buffer.
	(riece-update-channel-list-indicator): Always redisplay
	channel-list indicator.
	(riece-format-channel-list-line): New function.
	(riece-update-buffers): Don't clear riece-channel-list-changed.
	(riece-join-channel): Don't set riece-channel-list-changed.
	(riece-part-channel): Ditto.

2003-10-13  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-addons): Add riece-button.

	* riece-display.el (riece-update-channel-list-buffer): Avoid to
	use format to preserve 'riece-identity property.

	* riece-unread.el (riece-unread-update-channel-list-buffer):
	Simplified.
	(riece-unread-insinuate): Delay adding
	riece-unread-update-channel-list-buffer to
	riece-update-buffer-functions.

	* riece-button.el: New add-on.
	* COMPILE (riece-modules): Add riece-button.
	* Makefile.am (EXTRA_DIST): Add riece-button.el

2003-10-08  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-close-server-process): 
	(riece-quit-server-process): Call riece-close-server-process
	instead of kill-process; call riece-exit if no process is available.

2003-10-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-channel-buffer-name): Check whether
	IDENTITY is a member of riece-current-channels.

2003-10-07  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-commands.el (riece-command-kick): Fix completing-read
	collection argument.

2003-10-05  Daiki Ueno  <ueno@unixuser.org>

	* riece-000.el: Require 'riece-commands.
	* riece-200.el: Don't require 'riece-commands.
	* riece-300.el: Ditto.

2003-10-05  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.2 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.2.

2003-10-05  Daiki Ueno  <ueno@unixuser.org>

	* riece-filter.el (riece-sentinel): Don't clear
	riece-reconnect-with-password.
	* riece-server.el (riece-open-server): Clear
	riece-reconnect-with-password here.

2003-10-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-globals.el (riece-join-channel-candidate): New variable.
	* riece-commands.el (riece-command-join): Prompt
	riece-join-channel-candidate.

	* riece-handle.el (riece-handle-invite-message): Set
	riece-join-channel-candidate when the user is invited.
	* riece-naming.el (riece-naming-assert-join): Clear
	riece-join-channel-candidate.

2003-10-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-completing-read-identity): Pass 6th &
	7th arguments to completing-read.

	* riece-commands.el (riece-command-part): Use 6th argument DEFAULT
	of riece-completing-read-identity.

	* riece-handle.el (riece-handle-invite-message): Fix parsing of
	parameters.

	* riece-display.el (riece-update-channel-list-buffer): Don't clear
	riece-channel-list-changed.
	(riece-update-buffers): Clear it.

2003-10-01  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-rdcc-save-directory): New user option.

2003-09-29  Daiki Ueno  <ueno@unixuser.org>

	* riece-000.el (riece-handle-001-message): Parse elements in
	riece-startup-channel-list.

2003-09-21  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-skk-kakutei.el
	(riece-skk-kakutei-command-enter-message-as-notice): Fix typo.

2003-09-20  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-startup-channel-list): Revive.
	* riece-000.el (riece-handle-001-message): Process
	riece-startup-channel-list.

	* riece-server.el (riece-open-server): Display "Logging in to
	XXX..." message.
	* riece-000.el (riece-handle-001-message): Clear "Logging in to
	XXX..." message; call riece-after-login-hook.

2003-09-07  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Simplified.

2003-09-02  Daiki Ueno  <ueno@unixuser.org>

	* riece-commands.el (riece-command-join): Extract target
	identity-prefix before applying riece-channel-p; format target.

2003-08-30  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.1 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.1.

2003-08-29  Daiki Ueno  <ueno@unixuser.org>

	* riece-guess.el (riece-guess-channel-try-functions): Default to
	nil.
	(riece-default-guess-channel): Abolish.
	(riece-command-guess-switch-to-channel): Reconstruct
	riece-guess-candidates when it is empty.

2003-08-28  Daiki Ueno  <ueno@unixuser.org>

	* riece-highlight.el (riece-dialogue-change-face): Use defvar to
	define.
	(riece-dialogue-notice-face): Ditto.
	(riece-dialogue-wallops-face): Ditto.
	(riece-dialogue-error-face): Ditto.
	(riece-dialogue-info-face): Ditto.
	(riece-dialogue-server-face): Ditto.
	(riece-dialogue-prefix-face): Ditto.
	(riece-channel-list-default-face): Ditto.
	(riece-channel-list-current-face): Ditto.

	* riece-unread.el (riece-channel-list-unread-face): Use defvar to
	define.

2003-08-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-history.el (riece-history-insinuate): Don't set
	riece-guess-channel-try-functions here.
	(riece-history-requires): Don't require riece-guess.

	* riece-unread.el (riece-unread-requires): Don't require
	riece-guess.
	(riece-unread-insinuate): Don't set
	riece-guess-channel-try-functions here.

2003-08-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-after-display-message-function):
	Rename from riece-unread-display-message-function.
	(riece-unread-after-switch-to-channel-function): Rename from
	riece-unread-channel-switch-hook.
	(riece-guess-channel-from-unread): New function.
	(riece-unread-requires): Require 'riece-guess and 'riece-history.
	(riece-unread-insinuate): Setup riece-guess-channel-try-functions.

	* riece-options.el (riece-addons): Add riece-guess, riece-history,
	and riece-url.

	* riece-layout.el (riece-reconfigure-windows-predicate): Don't
	check riece-last-channel.

	* riece-display.el (riece-switch-to-channel): Rename
	riece-channel-switch-hook to
	riece-after-switch-to-channel-functions.
	(riece-switch-to-nearest-channel): Ditto.

	* riece-guess.el: New add-on.
	* COMPILE (riece-modules): Add riece-guess.
	* Makefile.am (EXTRA_DIST): Add riece-guess.el

	* riece-history.el: New add-on.
	* COMPILE (riece-modules): Add riece-history.
	* Makefile.am (EXTRA_DIST): Add riece-history.el

2003-08-27  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-connection-timeout): Abolish.

	* riece-server.el (riece-clear-system): Abolish.
	* riece.el (riece-exit): Merge riece-clear-system.

2003-08-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-filter.el (riece-sentinel): Suppress status message when
	riece-debug is nil.

2003-08-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-highlight.el (riece-channel-list-mark-current-channel):
	New function.

	* riece-display.el (riece-channel-list-changed): New variable.
	(riece-update-channel-list-buffer): Check riece-channel-list-changed.
	(riece-update-channel-list-indicator): Ditto.

2003-08-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-addons): Enable riece-unread by default.

	* riece-highlight.el (riece-channel-list-current-face): New variable.
	(riece-channel-list-default-face): New face.

	* riece-globals.el (riece-channel-list-buffer): Strip leading
	whitespace.

2003-08-26  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el: Require 'riece-highlight when compiling.
	(riece-unread): New custom group.
	(riece-channel-list-unread-face): New variable.
	(riece-channel-list-unread-face): New face.
	(riece-unread-requires): New function.
	(riece-unread-insinuate): Add ?! to riece-channel-list-mark-face-alist.

	* riece-highlight.el: Highlight *Channels* buffer; rename
	riece-*-face -> riece-dialogue-*-face, riece-highlight-* ->
	riece-dialogue-*.
	(riece-channel-list-font-lock-keywords): New variable.
	(riece-channel-list-mark-face-alist): New variable.

2003-08-25  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-update-channel-list-buffer):
	Restore channel marks if exist.

	* riece-naming.el (riece-naming-assert-join): Don't set
	riece-redisplay-buffers.
	(riece-naming-assert-part): Ditto.
	(riece-naming-assert-rename): Ditto.

	* riece-display.el (riece-redisplay-buffers): Abolish.
	(riece-update-user-list-buffer): Don't check
	riece-redisplay-buffers.
	(riece-update-channel-list-buffer): Ditto; prefix "*" at the
	beginning of the current channel.
	(riece-switch-to-channel): Don't set riece-redisplay-buffers.
	(riece-join-channel): Ditto.
	(riece-part-channel): Ditto.

2003-08-25  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-join-channel): Parse non-nil elements in
	riece-default-channel-binding.

2003-08-25  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-format-identity): Add 'riece-identity
	property to the resulting string.

	* riece-misc.el (riece-concat-channel-topic): Don't append ":" if
	topic is "".

	* riece-300.el (riece-handle-322-message): Simplify message.

	* riece-commands.el (riece-command-change-layout): Call
	riece-command-configure-windows; Use setq instead of
	custom-set-variables.

2003-08-25  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.1.0 released.
	* riece-version.el (riece-version-number): Bump up to 0.1.0.

2003-08-25  Daiki Ueno  <ueno@unixuser.org>

	* COMPILE (riece-compile-modules): Ignore errors during byte
	compilation.
	(riece-install-modules): If there lacks a compiled module, don't
	attempt to install it.

	* riece-options.el (riece-quit-timeout): Default to 10.

	* riece.el (riece-dialogue-mode-map): Bind riece-command-change-layout.
	(riece): Switch to riece-command-buffer before riece-redisplay-buffers.

	* riece-unread.el: Require 'riece-commands.

	* riece-server.el: Require 'riece-identity and 'riece-compat.

	* riece-ndcc.el: Require 'riece-globals, 'riece-options,
	'riece-display.
	(riece-handle-dcc-request): Use riece-channel-buffer-name.

	* riece-identity.el: Don't require 'riece-server.

	* riece-doctor.el: Require 'riece-globals, 'riece-identity,
	'riece-message, and 'riece-server.

	* riece-ctcp.el: Require 'riece-display.

	* riece-commands.el: Require 'riece-layout.
	(riece-command-change-layout): New command.

	* riece-alias.el: Require 'riece-identity.

	* riece-layout.el: No longer provided as an add-on.
	* riece-display.el: Remove window configuration stuff.

2003-08-24  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-command-dcc-send): Bind
	process-connection-type to nil.

	* riece-300.el (riece-handle-319-message): New handler.

	* riece.el (riece-buffer-mode-alist): Add riece-command-buffer.
	(riece): Signal an error when a server is opened;
	No need to initialize riece-command-buffer specially.

2003-08-22  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-display.el (riece-configure-windows-top): Set
	`truncate-partial-width-windows' nil, when horizontal window
	split.

2003-08-21  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-display.el (riece-configure-windows-top): Change
	user-list-buffer and channel-list-buffer window create logic.

	* riece-skk-kakutei.el (riece-skk-kakutei-insinuate): Add
	require riece.el when compile.

	* riece.el (riece): Use `riece-redisplay-buffers' instead of
	`riece-configure-windows'.

2003-08-20  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* riece-display.el (riece-configure-windows-top): New function.
	* riece-layout.el (riece-layout-alist): Add top.

	* riece-skk-kakutei.el: New add-on.
	* COMPILE (riece-modules): Add riece-skk-kakutei.
	* Makefile.am (EXTRA_DIST): Add riece-skk-kakutei.el

2003-08-19  Daiki Ueno  <ueno@unixuser.org>

	* riece-layout.el: New add-on.
	* COMPILE (riece-modules): Add riece-layout.
	* Makefile.am (EXTRA_DIST): Add riece-layout.el

2003-08-17  Daiki Ueno  <ueno@unixuser.org>

	* riece-options.el (riece-quit-timeout): New user option.
	* riece-server.el (riece-quit-server-process): New function.
	* riece-commands.el (riece-command-quit): Use it.
	(riece-command-close-server): Use it.

2003-08-17  Daiki Ueno  <ueno@unixuser.org>

	* riece-commands.el (riece-command-previous-channel): Skip nil in
	riece-current-channels.

2003-08-09  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-command-dcc-send): Accept output only from
	the ruby process.

	* riece-xemacs.el: Don't require 'riece-compat.

2003-08-06  Daiki Ueno  <ueno@unixuser.org>

	* riece-unread.el (riece-unread-update-channel-list-buffer): Call
	riece-parse-identity.

2003-08-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-find-server-name): Abolish.

	* riece-alias.el: Add usage.

2003-08-04  Daiki Ueno  <ueno@unixuser.org>

	* riece-mini.el (riece-mini-send-message): Use
	riece-completing-read-identity; don't use riece-own-channel-message.

	* riece-identity.el: Require 'riece-compat.
	(riece-identity-prefix-case-table): New variable.
	(riece-abbrev-identity-string-function): New variable.
	(riece-expand-identity-string-function): New variable.
	(riece-format-identity): Rename from riece-decode-identity.
	(riece-parse-identity): Rename from riece-encode-identity.
	(riece-with-identity-buffer): Abolish.
	(riece-identity-canonicalize-prefix): Use case-table.	

	* riece-filter.el (riece-handle-numeric-reply): Decode messages.
	(riece-handle-message): Ditto.

	* riece-alias.el: New add-on.
	* COMPILE (riece-modules): Add riece-alias.
	* Makefile.am (EXTRA_DIST): Add riece-alias.el.

	* riece-emacs.el (riece-set-case-syntax-pair): New alias.
	* riece-xemacs.el (riece-set-case-syntax-pair): New alias.
	* riece-identity.el (riece-identity-canonicalize-prefix): Simplified.

2003-08-03  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.0.4 released.
	* riece-version.el (riece-version-number): Bump up to 0.0.4.

2003-06-24  OHASHI Akira  <bg66@koka-in.org>

	* riece-unread.el (riece-unread-display-message-function): Don't check
	`selected-window'. It doesn't work as expected.

2003-06-23  Daiki Ueno  <ueno@unixuser.org>

	* riece-misc.el (riece-channel-p): Moved from riece-channel.el.

	* riece-300.el: Rewrite using riece-decode-identity.

	* riece-identity.el (riece-completing-read-identity): Signal an
	error when the encoded channel name is not matched with
	riece-channel-regexp.

	* riece-globals.el (riece-channel-regexp): Moved from
	riece-channel.el.
	(riece-user-regexp): Moved form riece-user.el.

2003-06-23  Daiki Ueno  <ueno@unixuser.org>

	* riece-handle.el (riece-handle-join-message): Don't call
	riece-switch-to-channel.
	(riece-handle-part-message): Don't decode message if it is empty.
	(riece-handle-kick-message): Ditto.
	(riece-handle-quit-message): Ditto.
	(riece-handle-kill-message): Ditto.

	* riece-commands.el (riece-command-part): Show the current channel
	as default candidate.

	* riece-identity.el (riece-completing-read-identity): Accept
	optional 5th argument `initial'.

	* riece-unread.el (riece-unread-update-channel-list-buffer):
	Simplified.

	* riece-filter.el (riece-sentinel): Don't bind
	riece-inhibit-update-buffers.

	* riece-display.el (riece-redisplay-buffer): New variable.
	(riece-inhibit-update-buffers): Abolish.
	(riece-update-channel-list-buffer): Memorize
	encoded identity as text property on each line.	

	* riece.el (riece-channel-list-mode): Make riece-redisplay-buffer
	buffer local.
	(riece-user-list-mode): Ditto.

2003-06-22  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* riece-log.el, riece-mini.el, riece-unread.el, riece-url.el:
	Fix example setting, don't use 3rd arg of add-to-list.

	* riece-coding.el (riece-default-coding-system): Fix default value.

2003-06-22  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-inhibit-update-buffers): New variable.
	* riece-filter.el (riece-sentinel): Bind
	riece-inhibit-update-buffers while removing channels from
	riece-current-channels.
	* riece-unread.el (riece-unread-display-message-function): Don't
	update channel list buffer when riece-inhibit-update-buffers is
	non-nil.
	(riece-unread-channel-switch-hook): Ditto.
	(riece-unread-insinuate): Add
	riece-unread-update-channel-list-buffer to
	riece-update-buffer-functions.

	* riece-commands.el (riece-command-switch-to-channel): Call
	riece-redisplay-buffers instead of riece-command-configure-windows.

	* riece-identity.el (riece-completing-read-identity): Remove nil
	from riece-current-channels before converting it to an alist.

2003-06-17  OHASHI Akira  <bg66@koka-in.org>

	* riece-unread.el (riece-unread-display-message-function): Check a
	`selected-window'.

	* riece-mini.el: New add-on.
	* COMPILE (riece-modules): Add `riece-mini'.
	* Makefile.am (EXTRA_DIST): Add `riece-mini.el'.

	* riece-display.el (riece-channel-buffer-create): Add new hook.
	* riece-log.el: New add-on for saving irc logs.
	* COMPILE (riece-modules): Add `riece-log'.
	* Makefile.am (EXTRA_DIST): Add `riece-log.el'.

	* riece-commands.el (riece-command-join): Use `let*' instead of `let'.
	(riece-command-part): Ditto.

2003-06-12  Daiki Ueno  <ueno@unixuser.org>

	* riece-naming.el (riece-naming-assert-join): Call
	riece-update-buffers.
	(riece-naming-assert-part): Ditto.

	* riece-filter.el (riece-sentinel): Don't bind
	riece-overriding-server-name; use riece-part-channel.

	* riece-display.el (riece-switch-to-channel): Don't set
	riece-channel-buffer.
	(riece-update-buffers): Set riece-channel-buffer here.

	* riece-commands.el (riece-command-switch-to-channel-by-number): Fixed.
	(riece-command-close-server): Fixed completion bug.
	(riece-command-universal-server-name-argument): Ditto.

2003-06-12  Daiki Ueno  <ueno@unixuser.org>

	* riece-doctor.el: Don't require 'doctor; autoload doctor-mode and
	doctor-read-print.

	* riece-handle.el (riece-handle-nick-message): Use
	riece-decode-identity to decode user.
	(riece-handle-join-message): Ditto.
	(riece-handle-part-message): Ditto.
	(riece-handle-kick-message): Ditto.
	(riece-handle-quit-message): Ditto.
	(riece-handle-kill-message): Ditto.
	(riece-handle-invite-message): Ditto.
	(riece-handle-topic-message): Ditto.
	(riece-handle-mode-message): Ditto.

2003-06-12  Daiki Ueno  <ueno@unixuser.org>

	* riece-message.el (riece-own-channel-message): Abolish.

	* riece-commands.el (riece-command-send-message): Don't use
	riece-own-channel-message.

	* riece-doctor.el (riece-doctor-reply): Don't use
	riece-own-channel-message.
	(riece-doctor-hello-regexp): New user option.
	(riece-doctor-bye-regexp): New user option.

2003-06-11  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-identity-member-no-server): Abolish.

	* riece-doctor.el (riece-doctor-patients): Make it global variable.
	(riece-doctor-after-privmsg-hook): Use riece-identity-member
	instead of riece-identity-member-no-server.

2003-06-11  Daiki Ueno  <ueno@unixuser.org>

	* riece-doctor.el: New add-on.
	* COMPILE (riece-modules): Add riece-doctor.
	* Makefile.am (EXTRA_DIST): Add riece-doctor.el

2003-06-11  Daiki Ueno  <ueno@unixuser.org>

	* riece-handle.el (riece-handle-nick-message): Follow the change
	of riece-identity-member.

	* riece-commands.el (riece-command-next-channel): Use
	riece-identity-member instead of riece-identity-member-no-server.
	(riece-command-previous-channel): Ditto.

2003-06-11  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-completing-read-identity): Remove nil
	from channels before completing-read.

	* riece-message.el (riece-message-make-name): Fix condition for priv.
	(riece-message-make-global-name): Ditto.
	(riece-message-buffer): Ditto.

	* riece-misc.el (riece-current-nickname): Use
	riece-with-identity-buffer.

2003-06-11  Daiki Ueno  <ueno@unixuser.org>

	* riece-message.el (riece-message-parent-buffers): Regard message's
	speaker as target when priv mode.

	* riece-display.el (riece-update-channel-indicator): Decode
	riece-current-channel even in priv mode.

	* riece-identity.el (riece-decode-identity): Respect prefix-only.
	(riece-completing-read-identity): Check if illegal characters in
	channel name.

2003-06-08  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-buffer-mode-alist): Add riece-user-list-buffer.
	* riece-globals.el (riece-user-buffer-format): Abolish.
	(riece-user-list-buffer): Default to " *Users*".
	* riece-display.el (riece-user-list-buffer-name): Abolish.
	(riece-user-list-buffer-create): Abolish.

2003-06-08  Daiki Ueno  <ueno@unixuser.org>

	* riece-filter.el (riece-handle-numeric-reply): Don't decode messages.
	(riece-handle-message): Ditto.
	(riece-sentinel): Clear system here.

	* riece-server.el (riece-server-process-name): New function.
	(riece-server-process): New function.
	(riece-close-server): Abolish.

	* riece-identity.el: Adopt vector object representation for
	identity objects.
	(riece-with-identity-buffer): New macro.
	(riece-decode-identity): New function.
	(riece-encode-identity): New function.

	* riece-globals.el (riece-process-list): New variable.
	(riece-server-process-alist): Abolish.
	(riece-channel-buffer-alist): Abolish.
	(riece-user-list-buffer-alist): Abolish.
	(riece-short-channel-indicator): New variable.

	* riece-channel.el: Assume that we are already in the server buffer.
	* riece-user.el: Likewise.

2003-06-06  OHASHI Akira  <bg66@koka-in.org>

	* riece-ndcc.el (riece-ndcc-server-sentinel): Close a parenthesis.

	* riece-rdcc.el (riece-rdcc-insinuate): Don't use the 3rd argument of
	`add-to-list'.

2003-06-06  Daiki Ueno  <ueno@unixuser.org>

	* riece-channel.el (riece-forget-channel): Fixed.
	(riece-channel-modeless-regexp): Abolish.
	(riece-channel-modeless-p): Abolish.

2003-06-06  OHASHI Akira  <bg66@koka-in.org>

	* riece-unread.el (riece-unread-display-message-function): Delete the
	target before adding to list.
	(riece-unread-switch-to-channel): New function.
	(riece-unread-insinuate): Bind "\C-c\C-u" to riece-command-mode-map.
	Bind "u" to riece-dialogue-mode-map.
	Bind "u" to riece-channel-list-mode-map.

	* riece.el (riece-channel-list-mode-map): Don't bind
	`riece-command-unread-channel'.

2003-06-04  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* riece-000.el,riece-200.el,riece-300.el,riece-400.el,riece-500.el,
	riece-commands.el,riece-filter.el,riece-handle.el,riece-highlight.el
	riece-identity.el,riece-message.el,riece-misc.el,riece-naming.el,
	riece.el: Don't require riece-inlines since it has been removed.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-update-user-list-buffer): Rename from
	riece-user-list-update-buffer.
	(riece-update-channel-list-buffer): Rename from
	riece-channel-list-update-buffer.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-identity.el (riece-identity-canonicalize-prefix): Moved
	from riece-inlines.el; renamed from scandinavian-downcase.
	(riece-identity-equal-no-server): Moved from riece-inlines.el;
	renamed from scandinavian-equal-ignore-case.
	(riece-identity-equal-no-server-safe): New function.
	(riece-identity-member-no-server): Moved from riece-inlines.el;
	renamed from scandinavian-member-ignore-case.
	(riece-identity-member-no-server-safe): New function.

	* riece-inlines.el: Removed.
	* COMPILE (riece-modules): Remove riece-inlines.
	* Makefile.am (EXTRA_DIST): Remove riece-inlines.el.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-rdcc-sentinel): Don't call delete-process
	explicitly.
	* riece-ndcc.el: Don't call delete-process explicitly.
	* riece-server.el (riece-close-server-process): Don't call
	delete-process explicitly unless riece-debug == t.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-inlines.el (scandinavian-downcase): New inline function.
	(scandinavian-equal-ignore-case): Rename from
	string-equal-ignore-case.
	(scandinavian-member-ignore-case): Rename from
	string-list-member-ignore-case.

	* riece-identity.el (riece-identity-equal): Rename from
	riece-identity-equal-no-server; use scandinavian-equal-ignore-case.
	(riece-identity-equal-safe): Rename from riece-identity-equal.
	(riece-identity-member): Rename from riece-identity-member-no-server.
	(riece-identity-member-safe): Rename from riece-identity-member.
	(riece-identity-assoc): Rename from riece-identity-assoc-no-server.
	(riece-identity-assoc-safe): Rename from riece-identity-assoc.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el: Require 'riece-ctcp.
	(riece-rdcc-insinuate): Add "DCC" to
	riece-ctcp-additional-clientinfo.

	* riece-ctcp.el (riece-ctcp-additional-clientinfo): New variable.
	(riece-command-ctcp-clientinfo): New command.
	(riece-ctcp-insinuate): Bind it in riece-dialogue-mode-map.
	(riece-handle-ctcp-clientinfo-request): New handler.
	(riece-handle-ctcp-clientinfo-response): New handler.

	* riece-server.el (riece-open-server): No need to use
	get-buffer-create to reuse process buffer.

2003-06-03  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el (riece-command-dcc-send): Generate new buffer for
	DCC process.
	(riece-command-dcc-receive): Likewise; don't set buffer-file-name.

	* riece-server.el (riece-server-keyword-map): `:coding-system' ->
	`:coding'.
	(riece-open-server): Follow the change.

	* riece-ctcp.el (riece-command-ctcp-action): New command.
	(riece-ctcp-insinuate): Bind it in riece-dialogue-mode-map.
	(riece-handle-ctcp-action-request): New handler.

	* riece.el (riece-command-mode): Enclose status indicators with
	`{}'; show riece-user-indicator.
	(riece-channel-mode): Likewise.
	(riece-dialogue-mode): Enclose status indicators with `{}'.
	* riece-globals.el (riece-user-indicator): New indicator.
	(riece-freeze-indicator): Default to "-".
	* riece-display.el (riece-update-channel-indicator): Don't update
	modeline.
	(riece-update-status-indicators): Set riece-user-indicator.
	* riece-300.el (riece-handle-324-message): Update channel indicator.

2003-06-02  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-command-mode): Don't set riece-freeze-indicator.
	(riece-dialogue-mode): Call riece-update-status-indicators.
	(riece-channel-mode): Add riece-operator-indicator to
	mode-line-buffer-identification.
	* riece-user.el (riece-make-user): New attribute `operator'.
	(riece-user-operator): New function.
	(riece-user-set-operator): New function.
	(riece-user-toggle-away): New function.
	(riece-user-toggle-operator): New function.
	* riece-misc.el (riece-own-frozen): Revive.
	* riece-message.el (riece-display-message): Reset riece-freeze if
	riece-freeze == 'own && (riece-message-own-p message).
	* riece-globals.el (riece-own-freeze): Abolish; use riece-freeze.
	(riece-operator-indicator): New variable.
	* riece-display.el (riece-update-status-indicators): New function.
	(riece-update-buffer-functions): Add it.
	* riece-commands.el (riece-command-toggle-freeze): Don't call
	riece-freeze.
	(riece-command-toggle-own-freeze): Don't call riece-own-freeze.
	* riece-300.el (riece-handle-302-message): Use
	riece-user-toggle-away instead of riece-user-set-away.
	(riece-handle-301-message): Ditto.
	(riece-handle-305-message): Ditto.
	(riece-handle-306-message): Ditto.
	(riece-handle-352-message): Ditto.

2003-06-02  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* riece-commands.el (riece-command-next-channel): Circularly
	follow the channel list.
	(riece-command-previous-channel): Ditto.

2003-06-02  Daiki Ueno  <ueno@unixuser.org>

	* riece.el (riece-command-mode): Set default value of riece-freeze
	& riece-own-freeze.
	* riece-options.el (riece-away-message): New user option.
	* riece-commands.el (riece-command-toggle-away): Query user away
	message.
	* riece-300.el (riece-handle-301-message): Set user's away status.
	(riece-handle-305-message): Ditto.
	(riece-handle-306-message): Ditto.
	(riece-handle-302-message): Ditto.
	(riece-handle-352-message): Ditto.

2003-06-02  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el: Require riece-globals, riece-misc, riece-channel,
	and riece-identity.
	(riece-command-dcc-receive): Check the existence of
	set-buffer-multibyte.

2003-06-02  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.0.3 released.
	* riece-version.el (riece-version-number): Bump up to 0.0.3.

	* riece-ctcp.el (riece-handle-ctcp-request): Catch errors occured
	in hooks.
	(riece-handle-ctcp-response): Ditto.

2003-06-01  Daiki Ueno  <ueno@unixuser.org>

	* riece-user.el (riece-rename-user): Don't modify entry when
	old-name == new-name.

	* riece-display.el (riece-configure-windows): Use window-buffer
	instead of current-buffer.

	* riece-rdcc.el (riece-rdcc-server-address): Default to nil.
	(riece-rdcc-ruby-command): New user option.
	(riece-rdcc-send-program): New user option.
	(riece-rdcc-decode-address-program): New user option.
	(riece-rdcc-substitute-variables): New function.
	(riece-command-dcc-send): Use it.
	(riece-rdcc-decode-address): Use it.

2003-06-01  Daiki Ueno  <ueno@unixuser.org>

	* riece-rdcc.el: New add-on.

	* Makefile.am (EXTRA_DIST): Add riece-rdcc.el

2003-06-01  Daiki Ueno  <ueno@unixuser.org>

	* riece-ndcc.el: New add-on.
	* Makefile.am (EXTRA_DIST): Add riece-ndcc.el

2003-05-31  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-open-server): Simplify message.

	* riece-commands.el (riece-command-open-server): Throw an error
	when the server is already opened.

	* riece-filter.el (riece-sentinel): Simplified.

	* riece-display.el (riece-user-list-update-buffer): Check the
	existence of riece-user-list-buffer.
	(riece-channel-list-update-buffer): Check the existence of
	riece-channel-list-buffer.
	(riece-set-window-points): Ditto.

	* riece-commands.el (riece-command-open-server): Simplified.
	(riece-command-toggle-channel-buffer-mode): Set
	riece-save-variables-are-dirty to t.
	(riece-command-toggle-user-list-buffer-mode): Ditto.
	(riece-command-toggle-channel-list-buffer-mode): Ditto.

	* riece-server.el (riece-start-server): Abolish.
	(riece-open-server): Set riece-server-process-alist and
	riece-server-process here.

2003-05-31  Daiki Ueno  <ueno@unixuser.org>

	* riece-filter.el (riece-sentinel): Close process even if
	riece-reconnect-with-password == t.
	(riece-handle-message): Catch errors occured in hooks.

	* riece-server.el (riece-open-server): Reuse server buffer.
	(riece-close-server-process): Delete process even if process is
	not running.

2003-05-31  Daiki Ueno  <ueno@unixuser.org>

	* riece-server.el (riece-open-server): No need to reset
	riece-reconnect-with-password.

	* riece-filter.el (riece-sentinel): Don't call riece when
	riece-reconnect-with-password = t and process !=
	riece-server-process.

	* riece-url.el: Fix usage.

	* riece-inlines.el (string-list-member-ignore-case): Remove docstring.

	* riece-unread.el: New add-on.
	* COMPILE (riece-modules): Add riece-unread.
	* Makefile.am (EXTRA_DIST): Add riece-unread.el

	* riece-300.el (riece-handle-322-message): New handler.
	(riece-handle-323-message): New handler.

2003-05-30  Daiki Ueno  <ueno@unixuser.org>

	* riece-display.el (riece-configure-windows): Select other window
	when minibuffer is active.

	* riece-commands.el (riece-command-list): New command.
	(riece-command-enter-message-as-notice): New command.
	* riece.el (riece-command-mode-map): Bind
	riece-command-enter-message-as-notice and riece-command-list.

	* riece-server.el (riece-close-server): Skip nil when leaving
	channels before closing server.

2003-05-30  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.0.2 released.
	* riece-version.el (riece-version-number): Bump up to 0.0.2.

	* riece.el (riece-load-and-build-addon-dependencies): Fixed.
	* riece-url.el (riece-url-requires): Don't assert dependency on
	riece-highlight unless it appears in riece-addons.

	* riece-url.el: New add-on.
	* COMPILE (riece-modules): Add riece-url.

	* riece-message.el (riece-message-make-bracket): Abolish.
	* riece-highlight.el (riece-highlight-font-lock-keywords):
	Give up to fontify "-nick-" or "-nick server-".

	* riece-highlight.el (riece-highlight-font-lock-keywords):
	Simplified regexp.

	* riece-ctcp.el (riece-handle-ctcp-request): Don't bind user.
	(riece-handle-ctcp-response): Ditto.

	* riece-highlight.el: Make it an add-on.
	(riece-highlight-insinuate): New function.
	* riece.el: Don't require 'riece-highlight.
	* riece-options.el (riece-addons): Turn on riece-highlight and
	riece-ctcp by default.

	* riece-display.el (riece-configure-windows-predicate): New function.
	(riece-configure-windows-predicate): New user option.
	(riece-redisplay-buffers): Use it.

	* riece-complete.el: Require 'cl for butlast.

	* Makefile.am (elc): Renamed from "compile".

	* riece.el (riece-dialogue-mode-map): Bind
	riece-command-toggle-channel-list-buffer-mode.

	* riece-display.el (riece-configure-windows): Typo fixed.

	* riece-user.el (riece-user-toggle-channel): Use member instead of
	memq.

2003-05-29  Daiki Ueno  <ueno@unixuser.org>

	* riece-ctcp.el (riece-ctcp-insinuate): New function.

	* riece-options.el (riece-addons): New user option.
	(riece-addon-directory): New user option.

	* riece.el (riece-load-and-build-addon-dependencies): New function.
	(riece-insinuate-addons): New function.
	(riece): Call riece-insinuate-addons.

	* riece-misc.el (riece-get-users-on-server): Moved from
	riece-commands.el.

	* riece-ctcp.el: New file.
	* COMPILE (riece-modules): Add riece-ctcp.
	* Makefile.am (EXTRA_DIST): Add riece-ctcp.el

2003-05-29  Daiki Ueno  <ueno@unixuser.org>

	* Riece: Version 0.0.1 released.

	* riece-commands.el (riece-command-names): New command.
	(riece-command-who): New command.

	* riece.el (riece-dialogue-mode-map): Bind riece-command-names and
	riece-command-who.

	* riece-300.el (riece-handle-341-message): New handler.
	(riece-handle-352-message): New handler.

	* riece-commands.el (riece-command-invite): Don't accept channel
	argument; throw an error when user is not on a channel.
	(riece-command-kick): New command.
